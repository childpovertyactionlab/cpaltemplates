---
title: "Colors & Palettes"
subtitle: "Complete guide to the CPAL color system"
---

```{r}
#| label: setup
#| include: false
library(cpaltemplates)
library(ggplot2)
library(dplyr)
```

## Overview

The cpaltemplates color system provides 21 functions for working with CPAL's carefully designed color palettes. All colors are sourced from `_brand.yml` and designed for WCAG accessibility compliance.

---

## Primary Brand Colors

CPAL's 5 core brand colors form the foundation of all palettes:

```{r}
#| label: primary-colors
cpal_colors_primary()
```

| Color | Hex | Use Case |
|-------|-----|----------|
| **Midnight** | `#004855` | Dark backgrounds, headers, emphasis |
| **Teal** | `#007A8C` | Primary brand color, links, highlights |
| **Pink** | `#C3257B` | Accent, call-to-action, contrast |
| **Orange** | `#ED683F` | Warnings, alerts, secondary accent |
| **Gold** | `#AB8C01` | Tertiary accent, highlights |

---

## Core Color Functions

### `cpal_colors()`

The main entry point for accessing any CPAL color or palette.

```{r}
#| label: cpal-colors-examples
# Get all primary colors
cpal_colors()

# Get a single color by name
cpal_colors("teal")

# Get multiple specific colors
cpal_colors(c("teal", "pink", "gold"))
```

```{r}
#| label: cpal-colors-palettes
# Get a palette
cpal_colors("teal_seq_5")

# Limit number of colors
cpal_colors("main", n = 3)

# Reverse palette order
cpal_colors("teal_seq_5", reverse = TRUE)
```

---

### `cpal_colors_extended()`

Returns all 17+ colors including primary colors and shades:

```{r}
#| label: extended-colors
cpal_colors_extended()
```

---

## Viewing Palettes

### All Available Palettes

```{r}
#| label: list-palettes
list_cpal_palettes()
```

### Visual Palette Display

```{r}
#| label: view-all-palettes
#| fig-height: 8
#| fig-cap: "All CPAL color palettes"
view_cpal_palettes()
```

---

## Palette Types

### Categorical Palettes

For discrete data with distinct categories:

```{r}
#| label: categorical-palettes
#| fig-height: 4
#| fig-cap: "Categorical palettes for discrete data"
view_cpal_palettes(c("main", "main_3", "main_4", "main_gray"))
```

**Usage example:**

```{r}
#| label: categorical-example
#| fig-cap: "Using categorical palette"
ggplot(mtcars, aes(x = factor(cyl), fill = factor(cyl))) +
  geom_bar() +
  scale_fill_cpal("main_3") +
  labs(title = "Count by Cylinder", x = "Cylinders", y = "Count") +
  theme_cpal() +
  theme(legend.position = "none")
```

---

### Sequential Palettes

For continuous or ordered data:

```{r}
#| label: sequential-palettes
#| fig-height: 4
#| fig-cap: "Sequential palettes for continuous data"
view_cpal_palettes(c("teal_seq_4", "teal_seq_5", "teal_seq_6", "yellow_teal_seq_5"))
```

**Usage example:**

```{r}
#| label: sequential-example
#| fig-cap: "Using sequential palette for continuous data"
ggplot(mtcars, aes(x = wt, y = mpg, color = hp)) +
  geom_point(size = 4) +
  scale_color_cpal_c("teal_seq_5") +
  labs(
    title = "Fuel Efficiency by Weight",
    subtitle = "Color shows horsepower",
    x = "Weight (1000 lbs)",
    y = "Miles per Gallon",
    color = "Horsepower"
  ) +
  theme_cpal()
```

---

### Diverging Palettes

For data with a meaningful midpoint:

```{r}
#| label: diverging-palettes
#| fig-height: 3
#| fig-cap: "Diverging palettes for data with midpoints"
view_cpal_palettes(c("pink_teal_3", "pink_teal_5", "pink_teal_6"))
```

**Usage example:**

```{r}
#| label: diverging-example
#| fig-cap: "Using diverging palette for change data"
# Create sample data with positive and negative changes
change_data <- data.frame(
  category = LETTERS[1:7],
  change = c(-15, -8, -2, 0, 5, 12, 20)
)

ggplot(change_data, aes(x = category, y = change, fill = change)) +
  geom_col() +
  scale_fill_gradient2(
    low = "#C3257B",
    mid = "#EBEBEB",
    high = "#007A8C",
    midpoint = 0
  ) +
  labs(
    title = "Year-over-Year Change",
    x = "Category",
    y = "Change (%)"
  ) +
  theme_cpal() +
  theme(legend.position = "none")
```

---

## ggplot2 Scale Functions

### Discrete Scales

```{r}
#| label: discrete-scale-example
#| fig-cap: "Using scale_color_cpal() for discrete data"
ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point(size = 3) +
  scale_color_cpal("main_3") +
  labs(
    title = "Discrete Color Scale",
    color = "Cylinders"
  ) +
  theme_cpal()
```

### Continuous Scales

```{r}
#| label: continuous-scale-example
#| fig-cap: "Using scale_fill_cpal_c() for continuous data"
ggplot(faithfuld, aes(waiting, eruptions, fill = density)) +
  geom_tile() +
  scale_fill_cpal_c("teal_seq_5") +
  labs(title = "Continuous Fill Scale") +
  theme_cpal()
```

---

## Color Interpolation

### `cpal_color_ramp()`

Generate smooth gradient between two colors:

```{r}
#| label: color-ramp
# Gradient from teal to pink
cpal_color_ramp("teal", "pink", n = 7)

# Using color names from brand.yml
cpal_color_ramp("teal_lightest", "midnight", n = 5)
```

### `cpal_color_gradient()`

Create gradient through multiple colors:

```{r}
#| label: color-gradient
# Three-color gradient
cpal_color_gradient(c("pink", "neutral", "teal"), n = 9)
```

---
## Color Validation (Accessibility)

### `validate_color_contrast()`

Check if two colors meet WCAG contrast requirements:

```{r}
#| label: contrast-validation
# Check teal on white (should pass AA)
validate_color_contrast("#007A8C", "#FFFFFF")

# Check with AAA standard (stricter)
validate_color_contrast("#007A8C", "#FFFFFF", level = "AAA")

# Midnight on white (high contrast)
validate_color_contrast("#004855", "#FFFFFF", level = "AAA")
```

### `validate_brand_colors()`

Check all CPAL palette colors for accessibility:

```{r}
#| label: brand-validation
#| eval: false
validate_brand_colors()
```

This function prints a detailed report showing which colors pass WCAG AA/AAA standards on white and dark backgrounds.

---

## Choosing the Right Palette

### Quick Reference

| Data Type | Recommended Palettes |
|-----------|---------------------|
| **Categories (â‰¤3)** | `main_3`, `compare` |
| **Categories (4-5)** | `main`, `main_4` |
| **Categories (6+)** | `main_gray` |
| **Sequential/Continuous** | `teal_seq_5`, `yellow_teal_seq_5` |
| **Diverging (with midpoint)** | `pink_teal_5`, `pink_teal_3` |
| **Binary comparison** | `compare`, `blues` |

---

## Complete Example

```{r}
#| label: complete-example
#| fig-cap: "Complete visualization with CPAL colors and theme"
# Prepare data
car_data <- mtcars |>
  mutate(
    cylinders = factor(cyl),
    efficiency = ifelse(mpg > median(mpg), "High", "Low")
  )

# Create visualization
ggplot(car_data, aes(x = hp, y = mpg, color = cylinders, size = wt)) +
  geom_point(alpha = 0.7) +
  scale_color_cpal("main_3") +
  scale_size_continuous(range = c(2, 8)) +
  labs(
    title = "Vehicle Performance Analysis",
    subtitle = "Fuel efficiency by horsepower, colored by cylinder count",
    x = "Horsepower",
    y = "Miles per Gallon",
    color = "Cylinders",
    size = "Weight (1000 lbs)",
    caption = "Source: Motor Trend Car Road Tests (1974)"
  ) +
  theme_cpal()
```

---

## Next Steps

- [Themes & Styling](themes-styling.qmd) - Apply consistent themes to your plots
- [Plots & Output](plots-visualizations.qmd) - Save and export visualizations
- [Brand & Assets](brand-assets.qmd) - Customize brand configuration
