{
  "hash": "7edeb86ccd85cdcc11e41fdf5fcee3fa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Plots & Output\"\nsubtitle: \"Creating and exporting CPAL visualizations\"\n---\n\n\n\n\n## Overview\n\nThis guide covers the utility functions for saving plots, adding branding elements, and ensuring accessibility in your visualizations.\n\n---\n\n## Plot Examples\n\nBefore diving into the utility functions, here are some complete examples of CPAL-styled visualizations:\n\n### Scatter Plot with Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +\n  geom_point(size = 3, alpha = 0.8) +\n  geom_smooth(method = \"lm\", se = TRUE, alpha = 0.2) +\n  scale_color_cpal(\"main_3\") +\n  labs(\n    title = \"Vehicle Fuel Efficiency\",\n    subtitle = \"Weight vs. MPG by cylinder count\",\n    x = \"Weight (1000 lbs)\",\n    y = \"Miles per Gallon\",\n    color = \"Cylinders\",\n    caption = \"Source: Motor Trend, 1974\"\n  ) +\n  theme_cpal()\n```\n\n::: {.cell-output-display}\n![Scatter plot with trend line](plots-visualizations_files/figure-html/scatter-example-1.png){width=80%}\n:::\n:::\n\n\n### Bar Chart\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars |>\n  count(cyl) |>\n  ggplot(aes(x = factor(cyl), y = n, fill = factor(cyl))) +\n  geom_col(alpha = 0.9) +\n  geom_text(aes(label = n), vjust = -0.5, fontface = \"bold\", color = \"#444444\") +\n  scale_fill_cpal(\"main_3\") +\n  labs(\n    title = \"Vehicle Count by Cylinder\",\n    x = \"Number of Cylinders\",\n    y = \"Count\"\n  ) +\n  theme_cpal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Bar chart with CPAL colors](plots-visualizations_files/figure-html/bar-example-1.png){width=80%}\n:::\n:::\n\n\n### Box Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mtcars, aes(x = factor(cyl), y = mpg, fill = factor(cyl))) +\n  geom_boxplot(alpha = 0.8, outlier.shape = 21) +\n  scale_fill_cpal(\"main_3\") +\n  labs(\n    title = \"Fuel Efficiency Distribution\",\n    subtitle = \"By cylinder count\",\n    x = \"Cylinders\",\n    y = \"Miles per Gallon\"\n  ) +\n  theme_cpal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Box plot comparing distributions](plots-visualizations_files/figure-html/boxplot-example-1.png){width=80%}\n:::\n:::\n\n\n### Line Chart\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create time series-like data\nline_data <- data.frame(\n  year = rep(2018:2023, 3),\n  value = c(\n    cumsum(rnorm(6, 5, 2)),\n    cumsum(rnorm(6, 4, 2)),\n    cumsum(rnorm(6, 3, 2))\n  ),\n  group = rep(c(\"Series A\", \"Series B\", \"Series C\"), each = 6)\n)\n\nggplot(line_data, aes(x = year, y = value, color = group)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 3) +\n  scale_color_cpal(\"main_3\") +\n  labs(\n    title = \"Trend Over Time\",\n    subtitle = \"Multiple series comparison\",\n    x = \"Year\",\n    y = \"Value\",\n    color = \"Series\"\n  ) +\n  theme_cpal()\n```\n\n::: {.cell-output-display}\n![Line chart with multiple series](plots-visualizations_files/figure-html/line-example-1.png){width=80%}\n:::\n:::\n\n\n---\n\n## Saving Plots\n\n### `save_cpal_plot()`\n\nSave plots with standardized CPAL dimensions and settings.\n\n```r\nsave_cpal_plot(\n  plot,\n  filename,\n  size = \"default\",\n  dpi = 300,\n  bg = \"white\",\n  ...\n)\n```\n\n#### Arguments\n\n| Argument | Description |\n|----------|-------------|\n| `plot` | A ggplot2 object |\n| `filename` | Output filename (extension determines format) |\n| `size` | Preset name or custom `c(width, height)` in inches |\n| `dpi` | Resolution (default: 300) |\n| `bg` | Background color (default: \"white\") |\n| `...` | Additional arguments passed to `ggsave()` |\n\n#### Size Presets\n\n| Preset | Dimensions (inches) | Aspect Ratio | Use Case |\n|--------|--------------------:|:------------:|----------|\n| `default` | 8 × 5 | 16:10 | General purpose |\n| `slide` | 10 × 5.625 | 16:9 | Presentations |\n| `half` | 4 × 3 | 4:3 | Half-page figures |\n| `third` | 2.5 × 2 | 5:4 | Small inline figures |\n| `square` | 5 × 5 | 1:1 | Square format |\n| `wide` | 12 × 4 | 3:1 | Panoramic charts |\n| `tall` | 5 × 8 | 5:8 | Vertical format |\n\n#### Examples\n\n```r\nlibrary(cpaltemplates)\nlibrary(ggplot2)\n\np <- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +\n  geom_point(size = 3) +\n  scale_color_cpal(\"main_3\") +\n  labs(title = \"Fuel Efficiency\") +\n  theme_cpal()\n\n# Save with default size\nsave_cpal_plot(p, \"efficiency_plot.png\")\n\n# Save for presentations\nsave_cpal_plot(p, \"efficiency_slide.png\", size = \"slide\")\n\n# Custom dimensions\nsave_cpal_plot(p, \"efficiency_custom.png\", size = c(10, 6))\n\n# Higher resolution for print\nsave_cpal_plot(p, \"efficiency_print.png\", size = \"default\", dpi = 600)\n\n# PDF output\nsave_cpal_plot(p, \"efficiency.pdf\", size = \"default\")\n\n# Transparent background\nsave_cpal_plot(p, \"efficiency_transparent.png\", bg = \"transparent\")\n```\n\n---\n\n## Adding Branding\n\n### `add_cpal_logo()`\n\nAdd the CPAL logo to any ggplot2 visualization.\n\n```r\nadd_cpal_logo(\n  plot,\n  position = c(\"top-right\", \"top-left\", \"bottom-right\", \"bottom-left\"),\n  size = 0.09,\n  logo_path = NULL\n)\n```\n\n#### Arguments\n\n| Argument | Description |\n|----------|-------------|\n| `plot` | A ggplot2 object |\n| `position` | Logo placement |\n| `size` | Logo size as proportion of plot (0-1) |\n| `logo_path` | Custom logo path (auto-detects CPAL logo) |\n\n#### Features\n\n- **Auto-detection**: Automatically uses white logo for dark themes\n- **Proper sizing**: Maintains aspect ratio\n- **Non-intrusive**: Places logo outside the plot area\n\n#### Examples\n\n**Default position (top-right):**\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(mtcars, aes(x = wt, y = mpg)) +\n  geom_point(color = \"#006878\", size = 3) +\n  labs(\n    title = \"Vehicle Fuel Efficiency\",\n    x = \"Weight (1000 lbs)\",\n    y = \"Miles per Gallon\"\n  ) +\n  theme_cpal()\n\nadd_cpal_logo(p)\n```\n\n::: {.cell-output-display}\n![Plot with CPAL logo in default position](plots-visualizations_files/figure-html/logo-default-1.png){width=80%}\n:::\n:::\n\n\n**Changing position when logo overlaps data:**\n\nIf the default top-right position overlaps your data, try a different corner:\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Data concentrated in top-right - use bottom-left\np_topright <- ggplot(mtcars, aes(x = wt, y = mpg)) +\n  geom_point(color = \"#006878\", size = 3) +\n  labs(title = \"Bottom-Left Logo\", subtitle = \"Best when data is in top-right\") +\n  theme_cpal()\n\nprint(add_cpal_logo(p_topright, position = \"bottom-left\"))\n```\n\n::: {.cell-output-display}\n![Comparing logo positions](plots-visualizations_files/figure-html/logo-positions-1.png){width=80%}\n:::\n\n```{.r .cell-code}\n# Data concentrated in bottom-left - use top-right\np_bottomleft <- ggplot(mtcars, aes(x = mpg, y = wt)) +\n  geom_point(color = \"#E86A50\", size = 3) +\n  labs(title = \"Top-Right Logo\", subtitle = \"Best when data is in bottom-left\") +\n  theme_cpal()\n\nprint(add_cpal_logo(p_bottomleft, position = \"top-right\"))\n```\n\n::: {.cell-output-display}\n![Comparing logo positions](plots-visualizations_files/figure-html/logo-positions-2.png){width=80%}\n:::\n:::\n\n\n**Adjusting logo size:**\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\np_base <- ggplot(mtcars, aes(x = wt, y = mpg)) +\n  geom_point(color = \"#006878\", size = 3) +\n  theme_cpal()\n\n# Smaller logo (0.06)\nprint(add_cpal_logo(p_base + labs(title = \"Smaller Logo (size = 0.06)\"),\n              position = \"bottom-right\", size = 0.06))\n```\n\n::: {.cell-output-display}\n![Different logo sizes](plots-visualizations_files/figure-html/logo-sizes-1.png){width=80%}\n:::\n\n```{.r .cell-code}\n# Larger logo (0.12)\nprint(add_cpal_logo(p_base + labs(title = \"Larger Logo (size = 0.12)\"),\n              position = \"bottom-right\", size = 0.12))\n```\n\n::: {.cell-output-display}\n![Different logo sizes](plots-visualizations_files/figure-html/logo-sizes-2.png){width=80%}\n:::\n:::\n\n\n**Dark theme (auto-selects white logo):**\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_dark <- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +\n  geom_point(size = 3) +\n  scale_color_cpal(\"main_3\") +\n  labs(\n    title = \"Dark Theme with Logo\",\n    subtitle = \"White logo is automatically selected\",\n    color = \"Cylinders\"\n  ) +\n  theme_cpal_dark()\n\nadd_cpal_logo(p_dark, position = \"bottom-right\")\n```\n\n::: {.cell-output-display}\n![Logo automatically adapts to dark theme](plots-visualizations_files/figure-html/logo-dark-1.png){width=80%}\n:::\n:::\n\n\n**Custom logo path:**\n\n```r\n# Use your own logo\np_custom <- add_cpal_logo(p, logo_path = \"path/to/custom_logo.png\")\n```\n\n---\n\n## Accessibility Checking\n\n### `check_plot_accessibility()`\n\nAnalyze a plot for accessibility issues.\n\n```r\ncheck_plot_accessibility(plot, verbose = TRUE)\n```\n\n#### What It Checks\n\n1. **Text Size**: Ensures text elements are large enough to read\n2. **Color Contrast**: Validates colors against WCAG standards\n3. **Colorblind Safety**: Checks if colors are distinguishable\n4. **Data-to-Ink Ratio**: Identifies unnecessary visual elements\n\n#### Examples\n\n```r\np <- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +\n  geom_point() +\n  scale_color_cpal(\"main_3\") +\n  theme_cpal()\n\n# Run accessibility check\ncheck_plot_accessibility(p)\n#> Checking plot accessibility...\n#>\n#> ── Text Size ──\n#> ✓ Title size: 18pt (OK)\n#> ✓ Axis text size: 12pt (OK)\n#> ✓ Legend text size: 12pt (OK)\n#>\n#> ── Color Contrast ──\n#> ✓ All colors pass WCAG AA on white background\n#>\n#> ── Colorblind Safety ──\n#> ✓ Color palette is distinguishable for common colorblindness types\n#>\n#> Overall: PASS\n\n# Quiet mode (returns TRUE/FALSE)\nis_accessible <- check_plot_accessibility(p, verbose = FALSE)\n```\n\n---\n\n## Workflow: Complete Plot Creation\n\n### Step-by-Step Example\n\n```r\nlibrary(cpaltemplates)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# 1. Prepare data\nplot_data <- mtcars |>\n  mutate(\n    cylinders = factor(cyl),\n    transmission = ifelse(am == 1, \"Manual\", \"Automatic\")\n  )\n\n# 2. Create the visualization\np <- ggplot(plot_data, aes(x = wt, y = mpg, color = cylinders)) +\n  geom_point(size = 3, alpha = 0.8) +\n  scale_color_cpal(\"main_3\") +\n  labs(\n    title = \"Fuel Efficiency by Vehicle Weight\",\n    subtitle = \"Analysis of 32 automobile models\",\n    x = \"Weight (1,000 lbs)\",\n    y = \"Miles per Gallon\",\n    color = \"Cylinders\",\n    caption = \"Source: Motor Trend, 1974\"\n  ) +\n  theme_cpal()\n\n# 3. Check accessibility\ncheck_plot_accessibility(p)\n\n# 4. Add branding\np_branded <- add_cpal_logo(p, position = \"top-right\")\n\n# 5. Save in multiple formats\nsave_cpal_plot(p_branded, \"efficiency_report.png\", size = \"default\")\nsave_cpal_plot(p_branded, \"efficiency_slide.png\", size = \"slide\")\nsave_cpal_plot(p_branded, \"efficiency_print.pdf\", size = \"default\", dpi = 600)\n```\n\n---\n\n## Size Selection Guide\n\n### By Output Context\n\n| Context | Recommended Size | Notes |\n|---------|-----------------|-------|\n| PowerPoint slide | `\"slide\"` | 16:9 aspect ratio |\n| Word document (full width) | `\"default\"` | Good for letter-size |\n| Word document (half page) | `\"half\"` | Side-by-side layouts |\n| PDF report | `\"default\"` | Standard dimensions |\n| Email/web | `\"default\"` or `\"slide\"` | Good balance |\n| Social media | `\"square\"` | Instagram, Twitter |\n| Dashboard | `\"wide\"` | Horizontal layouts |\n| Infographic | `\"tall\"` | Vertical scrolling |\n\n### DPI Guidelines\n\n| Output | Recommended DPI |\n|--------|-----------------|\n| Screen/web | 72-150 |\n| Standard print | 300 |\n| High-quality print | 600 |\n| Large format | 150-300 |\n\n```r\n# Web/screen\nsave_cpal_plot(p, \"web.png\", dpi = 150)\n\n# Print quality\nsave_cpal_plot(p, \"print.png\", dpi = 300)\n\n# High-res print\nsave_cpal_plot(p, \"highres.png\", dpi = 600)\n```\n\n---\n\n## Output Formats\n\n### Supported Formats\n\n| Extension | Type | Best For |\n|-----------|------|----------|\n| `.png` | Raster | Web, presentations, general use |\n| `.jpg` | Raster | Photos, web (smaller files) |\n| `.pdf` | Vector | Print, publications, scaling |\n| `.svg` | Vector | Web, interactive, scaling |\n| `.eps` | Vector | LaTeX, professional printing |\n| `.tiff` | Raster | High-quality print, archival |\n\n### Format Selection\n\n```r\n# PNG for web/presentations (most common)\nsave_cpal_plot(p, \"plot.png\")\n\n# PDF for print/publications\nsave_cpal_plot(p, \"plot.pdf\")\n\n# SVG for web with scaling\nsave_cpal_plot(p, \"plot.svg\")\n\n# TIFF for journals requiring it\nsave_cpal_plot(p, \"plot.tiff\", dpi = 600)\n```\n\n---\n\n## Common Patterns\n\n### Batch Processing\n\n```r\nlibrary(purrr)\n\n# Create multiple plots\nplots <- list(\n  cyl4 = filter(mtcars, cyl == 4),\n  cyl6 = filter(mtcars, cyl == 6),\n  cyl8 = filter(mtcars, cyl == 8)\n) |>\n  map(~{\n    ggplot(.x, aes(x = wt, y = mpg)) +\n      geom_point(color = \"#007A8C\") +\n      theme_cpal()\n  })\n\n# Save all plots\niwalk(plots, ~{\n  save_cpal_plot(.x, paste0(\"efficiency_\", .y, \".png\"))\n})\n```\n\n### Report Figure Set\n\n```r\n# Create consistent figures for a report\ncreate_report_figure <- function(data, title, filename) {\n  p <- ggplot(data, aes(x = wt, y = mpg)) +\n    geom_point(color = \"#007A8C\") +\n    labs(title = title) +\n    theme_cpal_print()\n\n  p_logo <- add_cpal_logo(p, position = \"bottom-right\", size = 0.07)\n\n  save_cpal_plot(p_logo, filename, size = \"default\", dpi = 300)\n\n  invisible(p_logo)\n}\n\n# Generate figures\ncreate_report_figure(mtcars, \"Figure 1: All Vehicles\", \"fig1.png\")\ncreate_report_figure(filter(mtcars, cyl == 4), \"Figure 2: 4-Cylinder\", \"fig2.png\")\n```\n\n### Presentation Deck\n\n```r\n# Create slides-ready plots\nslides <- list(\n  list(data = mtcars, title = \"Overview\"),\n  list(data = filter(mtcars, am == 1), title = \"Manual Transmission\"),\n  list(data = filter(mtcars, am == 0), title = \"Automatic Transmission\")\n)\n\nfor (i in seq_along(slides)) {\n  p <- ggplot(slides[[i]]$data, aes(x = wt, y = mpg, color = factor(cyl))) +\n    geom_point(size = 4) +\n    scale_color_cpal(\"main_3\") +\n    labs(title = slides[[i]]$title) +\n    theme_cpal(base_size = 20)  # Larger for slides\n\n  save_cpal_plot(p, sprintf(\"slide_%02d.png\", i), size = \"slide\")\n}\n```\n\n---\n\n## Troubleshooting\n\n### Logo Not Appearing\n\n```r\n# Check that cowplot is installed\nif (!requireNamespace(\"cowplot\", quietly = TRUE)) {\n  install.packages(\"cowplot\")\n}\n\n# Check that magick is installed\nif (!requireNamespace(\"magick\", quietly = TRUE)) {\n  install.packages(\"magick\")\n}\n```\n\n### Fonts Not Rendering in Saved Files\n\n```r\n# Ensure fonts are registered before saving\nsetup_cpal_google_fonts()\n\n# For PDF output, use Cairo device\nsave_cpal_plot(p, \"plot.pdf\", device = cairo_pdf)\n```\n\n### File Size Too Large\n\n```r\n# Reduce DPI for web\nsave_cpal_plot(p, \"plot.png\", dpi = 150)\n\n# Use JPEG for photos\nsave_cpal_plot(p, \"plot.jpg\", quality = 85)\n\n# Simplify the plot\np_simple <- p + theme(panel.grid = element_blank())\nsave_cpal_plot(p_simple, \"plot.png\")\n```\n\n---\n\n## Next Steps\n\n- [Colors & Palettes](colors-palettes.qmd) - Color system reference\n- [Themes & Styling](themes-styling.qmd) - Theme customization\n- [Interactive Features](interactive-features.qmd) - Creating interactive plots\n",
    "supporting": [
      "plots-visualizations_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}