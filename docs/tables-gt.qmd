---
title: "Tables"
subtitle: "GT and Reactable tables with CPAL styling"
---

```{r}
#| label: setup
#| include: false
library(cpaltemplates)
library(ggplot2)
library(dplyr)
library(gt)
```

## Overview

cpaltemplates provides 3 table functions for creating professionally styled tables:

- **`cpal_table_gt()`** - Static, publication-quality tables using gt
- **`cpal_table_reactable()`** - Interactive, searchable tables using reactable
- **`cpal_table()`** - Quick CPAL-styled gt tables

---

## Quick Start

```{r}
#| label: quick-table
mtcars |>
  head(5) |>
  select(mpg, cyl, hp, wt) |>
  cpal_table_gt(title = "Vehicle Data Sample")
```

---

## GT Tables

### `cpal_table_gt()`

Create publication-quality static tables with CPAL styling.

```{r}
#| label: gt-basic
mtcars |>
  head(8) |>
  select(mpg, cyl, disp, hp, wt) |>
  mutate(car = rownames(head(mtcars, 8))) |>
  select(car, everything()) |>
  cpal_table_gt(
    title = "Vehicle Specifications",
    subtitle = "Sample from mtcars dataset",
    source = "Source: Motor Trend, 1974"
  )
```

### Formatted Data

```{r}
#| label: gt-formatted
# Create summary data
summary_data <- mtcars |>
  group_by(cyl) |>
  summarise(
    count = n(),
    avg_mpg = mean(mpg),
    avg_hp = mean(hp),
    avg_wt = mean(wt),
    .groups = "drop"
  )

summary_data |>
  cpal_table_gt(
    title = "Performance by Cylinder Count"
  ) |>
  fmt_number(columns = c(avg_mpg, avg_hp, avg_wt), decimals = 1) |>
  cols_label(
    cyl = "Cylinders",
    count = "Count",
    avg_mpg = "Avg. MPG",
    avg_hp = "Avg. HP",
    avg_wt = "Avg. Weight"
  )
```

---

### Advanced GT Formatting

```{r}
#| label: gt-advanced
# Regional data example
regional_data <- data.frame(
  region = c("North Dallas", "South Dallas", "East Dallas", "West Dallas"),
  population = c(125000, 98500, 156000, 112000),
  growth_rate = c(0.052, -0.018, 0.087, 0.034),
  poverty_rate = c(0.08, 0.22, 0.12, 0.15)
)

regional_data |>
  cpal_table_gt(title = "Dallas Regional Statistics") |>
  fmt_number(columns = population, use_seps = TRUE) |>
  fmt_percent(columns = c(growth_rate, poverty_rate), decimals = 1) |>
  cols_label(
    region = "Region",
    population = "Population",
    growth_rate = "Growth Rate",
    poverty_rate = "Poverty Rate"
  ) |>
  tab_style(
    style = cell_fill(color = "#D8EFF4"),
    locations = cells_body(
      columns = growth_rate,
      rows = growth_rate > 0.05
    )
  ) |>
  tab_style(
    style = cell_text(color = "#C3257B", weight = "bold"),
    locations = cells_body(
      columns = poverty_rate,
      rows = poverty_rate > 0.15
    )
  )
```

---

## Reactable Tables

### `cpal_table_reactable()`

Create interactive tables with searching, sorting, and pagination.

```{r}
#| label: reactable-basic
mtcars |>
  mutate(car = rownames(mtcars)) |>
  select(car, mpg, cyl, hp, wt, qsec) |>
  head(15) |>
  cpal_table_reactable(
    title = "Vehicle Database",
    searchable = TRUE,
    pagination = TRUE,
    page_size = 8
  )
```

### With Column Filtering

```{r}
#| label: reactable-filter
mtcars |>
  mutate(car = rownames(mtcars)) |>
  select(car, mpg, cyl, hp, wt) |>
  cpal_table_reactable(
    title = "Filterable Table",
    subtitle = "Use column filters to explore data",
    searchable = TRUE,
    filterable = TRUE,
    page_size = 10
  )
```

---

## Choosing Between GT and Reactable

| Feature | GT | Reactable |
|---------|:---:|:---------:|
| Static output | ✓ | |
| Interactive | | ✓ |
| Searchable | | ✓ |
| Sortable | | ✓ |
| PDF/Print friendly | ✓ | |
| Shiny integration | ✓ | ✓ |
| Large datasets | | ✓ |
| Complex formatting | ✓ | |
| Pagination | | ✓ |

### Recommendations

| Use Case | Recommended |
|----------|-------------|
| Reports/PDFs | `cpal_table_gt()` |
| Dashboards | `cpal_table_reactable()` |
| Presentations | `cpal_table_gt()` |
| Data exploration | `cpal_table_reactable()` |
| Publications | `cpal_table_gt()` |
| Web apps | `cpal_table_reactable()` |

---

## Complete Example

### Summary Report Table

```{r}
#| label: complete-example
# Prepare comprehensive summary
comprehensive_summary <- mtcars |>
  group_by(cyl, am) |>
  summarise(
    n = n(),
    mpg_mean = mean(mpg),
    mpg_sd = sd(mpg),
    hp_mean = mean(hp),
    .groups = "drop"
  ) |>
  mutate(
    transmission = ifelse(am == 1, "Manual", "Automatic")
  ) |>
  select(-am)

comprehensive_summary |>
  cpal_table_gt(
    title = "Vehicle Performance Summary",
    subtitle = "Grouped by cylinder count and transmission type",
    source = "Source: Motor Trend Car Road Tests (1974)"
  ) |>
  fmt_number(columns = c(mpg_mean, mpg_sd, hp_mean), decimals = 1) |>
  cols_label(
    cyl = "Cylinders",
    transmission = "Transmission",
    n = "Count",
    mpg_mean = "Avg. MPG",
    mpg_sd = "MPG SD",
    hp_mean = "Avg. HP"
  ) |>
  tab_spanner(
    label = "Fuel Efficiency",
    columns = c(mpg_mean, mpg_sd)
  )
```

---

## Next Steps

- [Shiny Dashboards](shiny-dashboards.qmd) - Using tables in dashboards
- [Themes & Styling](themes-styling.qmd) - Consistent styling
- [Workflows](workflow-integration.qmd) - Complete examples
