---
title: "Getting Started"
subtitle: "Installation, setup, and your first CPAL visualization"
---

## Installation

### From GitHub

cpaltemplates is hosted on GitHub and can be installed using `remotes` or `devtools`:
```r
# Using remotes (recommended)
install.packages("remotes")
remotes::install_github("childpovertyactionlab/cpaltemplates")

# Or using devtools
install.packages("devtools")
devtools::install_github("childpovertyactionlab/cpaltemplates")
```

### Dependencies

cpaltemplates requires R version 4.3.0 or higher. The package will automatically install required dependencies, but you may want to install suggested packages for full functionality:

```r
# Core dependencies (installed automatically)
# fs, ggplot2, cli, yaml, gt, reactable, bslib, sass

# Suggested packages for extended features
install.packages(c(
  "ggiraph",      # Interactive visualizations
  "cowplot",      # Logo placement
  "magick",       # Image processing for logos
  "showtext",     # Google Fonts for static plots
  "sysfonts",     # Font management
  "gdtools",      # Font rendering for interactive plots
  "patchwork"     # Theme preview
))
```

---

## Initial Setup

### Loading the Package

```r
library(cpaltemplates)
```

### Font Setup

CPAL visualizations use **Inter** (primary) and **Roboto** (secondary) fonts from Google Fonts. Run this setup once per R session:

```r
# Set up fonts for both static and interactive plots
setup_cpal_google_fonts()
```

::: {.callout-tip}
## Pro Tip
Add `setup_cpal_google_fonts()` to your project's setup script or `.Rprofile` to ensure fonts are always available.
:::

### Verifying Installation

Run these commands to verify everything is working:

```r
# Check that colors load correctly
cpal_colors_primary()
#>   midnight       teal       pink     orange       gold
#>  "#004855"  "#007A8C"  "#C3257B"  "#ED683F"  "#AB8C01"

# Check that themes work
library(ggplot2)
p <- ggplot(mtcars, aes(wt, mpg)) +
  geom_point() +
  theme_cpal()
print(p)

# Check font availability
cpal_font_family()
#> [1] "Inter"  # or "Roboto" or "sans" if fonts unavailable
```

---

## Understanding the Package Structure

cpaltemplates is organized into functional categories:

```
cpaltemplates/
├── Color System (21 functions)
│   ├── Core: cpal_colors(), cpal_colors_primary(), cpal_colors_extended()
│   ├── Palettes: cpal_palettes(), cpal_palettes_sequential(), etc.
│   ├── Validation: validate_color_contrast(), validate_brand_colors()
│   ├── Interpolation: cpal_color_ramp(), cpal_color_gradient()
│   └── Scales: scale_color_cpal(), scale_fill_cpal(), etc.
│
├── Theme System (8 functions)
│   ├── Themes: theme_cpal(), theme_cpal_minimal(), theme_cpal_dark(), etc.
│   ├── Session: set_theme_cpal()
│   └── Preview: preview_cpal_themes()
│
├── Tables (3 functions)
│   ├── cpal_table(), cpal_table_gt(), cpal_table_reactable()
│
├── Interactive (7 functions)
│   ├── ggiraph: cpal_interactive(), cpal_point_interactive(), etc.
│   └── mapgl: cpal_mapgl(), cpal_mapgl_layer()
│
├── Project Scaffolding (7 functions)
│   ├── start_project()
│   └── use_*() helpers
│
├── Brand & Assets (4 functions)
│   ├── use_cpal_brand(), validate_cpal_brand()
│   └── get_cpal_asset(), update_cpal_assets()
│
├── Shiny/Dashboard (5 functions)
│   ├── cpal_dashboard_theme()
│   └── SCSS enhancements
│
└── Utilities (7 functions)
    ├── Fonts: cpal_font_family(), setup_cpal_google_fonts()
    └── Plots: save_cpal_plot(), add_cpal_logo(), check_plot_accessibility()
```

---

## Your First Visualization

Let's create a complete, branded visualization step by step:

### Step 1: Load Libraries

```r
library(cpaltemplates)
library(ggplot2)
library(dplyr)
```

### Step 2: Prepare Data

```r
# Using built-in mtcars dataset
car_data <- mtcars |>
  mutate(
    cylinders = factor(cyl),
    car_name = rownames(mtcars)
  )
```

### Step 3: Create the Plot

```r
p <- ggplot(car_data, aes(x = wt, y = mpg, color = cylinders)) +
  geom_point(size = 3, alpha = 0.8) +
  scale_color_cpal("main_3") +
  labs(
    title = "Fuel Efficiency by Vehicle Weight",
    subtitle = "Heavier vehicles tend to have lower fuel efficiency",
    x = "Weight (1,000 lbs)",
    y = "Miles per Gallon",
    color = "Cylinders",
    caption = "Source: Motor Trend Car Road Tests (1974)"
  ) +
  theme_cpal()

print(p)
```

### Step 4: Save the Plot

```r
# Save with standard dimensions
save_cpal_plot(p, "my_first_cpal_plot.png", size = "default")

# Save for slides
save_cpal_plot(p, "my_first_cpal_plot_slide.png", size = "slide")
```

### Step 5: Add Logo (Optional)

```r
# Add CPAL logo to the plot
p_with_logo <- add_cpal_logo(p, position = "top-right")
print(p_with_logo)
```

---

## Quick Reference

### Essential Functions

| Task | Function |
|------|----------|
| Get brand colors | `cpal_colors_primary()` |
| Apply color scale | `scale_color_cpal("main")` |
| Apply theme | `theme_cpal()` |
| Save plot | `save_cpal_plot(p, "file.png")` |
| Create table | `cpal_table_reactable(data)` |
| Start project | `start_project("name", "analysis")` |

### Essential Palettes

| Palette | Use Case | Colors |
|---------|----------|--------|
| `main` | Categorical data | 5 |
| `main_3` | Simple comparisons | 3 |
| `teal_seq_5` | Sequential/continuous | 5 |
| `pink_teal_5` | Diverging data | 5 |

### Essential Themes

| Theme | Use Case |
|-------|----------|
| `theme_cpal()` | Default, most situations |
| `theme_cpal_minimal()` | Clean, simple designs |
| `theme_cpal_dark()` | Presentations, dark mode |
| `theme_cpal_print()` | Print publications |

---

## Next Steps

Now that you have cpaltemplates set up, explore these guides:

1. **[Colors & Palettes](colors-palettes.qmd)** - Deep dive into the color system
2. **[Themes & Styling](themes-styling.qmd)** - Customize your visualizations
3. **[Project Setup](project-setup.qmd)** - Create standardized project structures
4. **[Workflows](workflow-integration.qmd)** - End-to-end examples

---

## Common Setup Issues

### Fonts Not Loading

If fonts aren't loading correctly:

```r
# Force refresh fonts
setup_cpal_google_fonts(force_refresh = TRUE, verbose = TRUE)

# Check what's available
cpal_font_family(setup = TRUE)
```

### Package Not Found

If installation fails:

```r
# Check R version
R.version.string
#> Should be 4.3.0 or higher

# Try with dependencies
remotes::install_github(
  "childpovertyactionlab/cpaltemplates",
  dependencies = TRUE
)
```

### Interactive Features Not Working

For ggiraph functionality:

```r
# Install ggiraph and dependencies
install.packages(c("ggiraph", "gdtools", "systemfonts"))

# Register fonts for interactive use
if (requireNamespace("gdtools", quietly = TRUE)) {
  gdtools::register_gfont("Inter")
  gdtools::register_gfont("Roboto")
}
```

See the [Troubleshooting Guide](troubleshooting.qmd) for more solutions.
