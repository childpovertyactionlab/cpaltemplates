---
title: "Brand & Assets"
subtitle: "Managing CPAL brand configuration and assets"
---

## Overview

cpaltemplates provides 4 functions for managing brand configuration and assets:

- `use_cpal_brand()` - Copy `_brand.yml` to your project
- `validate_cpal_brand()` - Validate brand configuration
- `get_cpal_asset()` - Access package assets (logos, icons)
- `update_cpal_assets()` - Update CSS and images

---

## The _brand.yml File

The `_brand.yml` file is the single source of truth for all CPAL branding. It defines colors, typography, and Bootstrap settings used throughout the package.

### Structure

```yaml
# _brand.yml
meta:
  name: Child Poverty Action Lab
  link: https://childpovertyactionlab.org

color:
  palette:
    # Primary Brand Colors
    midnight: "#004855"
    teal: "#007A8C"
    pink: "#C3257B"
    orange: "#ED683F"
    gold: "#AB8C01"

    # Neutrals
    white: "#FFFFFF"
    neutral: "#EBEBEB"
    gray: "#919191"
    black: "#1A1A1A"

    # Extended palette...

  # Semantic assignments
  foreground: black
  background: white
  primary: teal
  secondary: midnight
  success: teal
  warning: gold
  danger: orange

typography:
  fonts:
    - family: "Poppins"
      source: google
    - family: "Inter"
      source: google
    - family: "Fira Code"
      source: google

  base:
    family: Poppins
  headings:
    family: Poppins
  monospace:
    family: Fira Code

defaults:
  bootstrap:
    defaults:
      "enable-rounded": true
      "enable-shadows": true
      "border-radius": "6px"
      # ...more Bootstrap variables
```

---

## Using Brand in Projects

### `use_cpal_brand()`

Copy the `_brand.yml` file to your project for local customization.

```r
use_cpal_brand(path = ".", overwrite = FALSE)
```

#### Arguments

| Argument | Description | Default |
|----------|-------------|---------|
| `path` | Destination directory | Current directory |
| `overwrite` | Replace existing file | FALSE |

#### Examples

```r
# Copy to current directory
use_cpal_brand()

# Copy to specific project
use_cpal_brand("my-dashboard/")

# Force overwrite
use_cpal_brand(overwrite = TRUE)

# Copy to subdirectory
use_cpal_brand("project/config/")
```

---

### `validate_cpal_brand()`

Validate that a `_brand.yml` file is correctly formatted.

```r
validate_cpal_brand(path = ".", verbose = TRUE)
```

#### What It Checks

1. **File Existence**: Is `_brand.yml` present?
2. **Required Sections**: Does it have `color`, `typography`, `defaults`?
3. **Color Format**: Are all colors valid hex codes?
4. **Typography**: Are required font families defined?
5. **Bootstrap Variables**: Are critical Bootstrap settings present?

#### Examples

```r
# Validate in current directory
validate_cpal_brand()
#> Validating _brand.yml...
#> ✓ File found: _brand.yml
#> ✓ Required sections present
#> ✓ All colors are valid hex codes
#> ✓ Typography configured correctly
#> ✓ Bootstrap defaults set
#> Validation passed!

# Validate specific file
validate_cpal_brand("path/to/_brand.yml")

# Quiet mode (returns TRUE/FALSE)
is_valid <- validate_cpal_brand(verbose = FALSE)
```

---

## Accessing Assets

### `get_cpal_asset()`

Get the file path to package assets (logos, icons, favicons).

```r
get_cpal_asset(asset_name, category = c("logos", "icons", "favicons"))
```

#### Available Assets

| Category | Assets |
|----------|--------|
| `logos` | `CPAL_Logo_Teal.png`, `CPAL_Logo_White.png`, `cpal-logo-wide.png` |
| `icons` | `CPAL_Icon_Teal.png`, `CPAL_Icon_White.png`, `CPAL_Skyline_*.png` |
| `favicons` | `CPAL_favicon.ico`, `cpal-favicon.ico` |

#### Examples

```r
# Get logo path
logo <- get_cpal_asset("CPAL_Logo_Teal.png", "logos")
#> [1] "/path/to/package/inst/assets/logos/CPAL_Logo_Teal.png"

# Use in Shiny
tags$img(src = logo, height = "50px")

# Get favicon
favicon <- get_cpal_asset("CPAL_favicon.ico", "favicons")

# Get icon
icon <- get_cpal_asset("CPAL_Icon_White.png", "icons")
```

---

### `update_cpal_assets()`

Update CSS and images in an existing project to the latest package versions.

```r
update_cpal_assets(path = ".", components = c("css", "images", "all"))
```

#### Examples

```r
# Update everything
update_cpal_assets(components = "all")

# Update only CSS
update_cpal_assets(components = "css")

# Update only images
update_cpal_assets(components = "images")

# Update in specific project
update_cpal_assets("my-dashboard/", components = "all")
```

---

## Customizing Brand

### Modifying Colors

After copying `_brand.yml` to your project, you can customize colors:

```yaml
# _brand.yml (customized)
color:
  palette:
    # Keep primary colors
    teal: "#007A8C"

    # Add custom colors for your project
    custom_blue: "#2E86AB"
    custom_green: "#A5BE00"

  # Override semantic colors
  primary: custom_blue  # Use your custom color as primary
```

### Adding Custom Fonts

```yaml
typography:
  fonts:
    - family: "Poppins"
      source: google
    - family: "Your Custom Font"
      source: file
      files:
        - path: fonts/custom-font.woff2
          weight: 400

  base:
    family: "Your Custom Font"
```

### Bootstrap Customization

```yaml
defaults:
  bootstrap:
    defaults:
      # Adjust border radius
      "border-radius": "8px"

      # Modify button styles
      "btn-border-radius": "4px"
      "btn-padding-x": "1.5rem"

      # Card styling
      "card-border-radius": "12px"
      "card-cap-padding-y": "1rem"
```

---

## Brand in Different Contexts

### In Quarto Documents

```yaml
# _quarto.yml
brand: _brand.yml

format:
  html:
    theme:
      - flatly
      - brand
```

### In Shiny Dashboards

```r
ui <- page_sidebar(
  theme = cpal_dashboard_theme(),  # Uses _brand.yml
  ...
)
```

### In ggplot2

```r
# Colors from brand are automatically available
ggplot(data, aes(color = group)) +
  scale_color_cpal("main")  # Uses brand colors

# Themes use brand fonts
theme_cpal()  # Uses Poppins/Inter from brand
```

---

## Best Practices

### 1. Keep _brand.yml in Version Control

```bash
# .gitignore - DO NOT add _brand.yml
# Keep it tracked for consistency
```

### 2. Validate After Changes

```r
# Always validate after editing
validate_cpal_brand()
```

### 3. Use Semantic Colors

```r
# Prefer semantic names over specific colors
cpal_colors("primary")  # Better
cpal_colors("teal")     # Also works, but less flexible
```

### 4. Document Custom Colors

```yaml
color:
  palette:
    # === Custom Project Colors ===
    # Added for Q3 2024 housing report
    housing_highlight: "#FF6B6B"
    housing_secondary: "#4ECDC4"
```

---

## Troubleshooting

### Brand File Not Found

```r
# Check if file exists
file.exists("_brand.yml")

# Copy from package
use_cpal_brand()
```

### Invalid Hex Colors

```r
# Validate to find issues
validate_cpal_brand()
#> ✗ Invalid color: 'pink' is not a valid hex code

# Fix in _brand.yml
# pink: "C3257B"  # Wrong - missing #
# pink: "#C3257B" # Correct
```

### Fonts Not Loading

```yaml
# Ensure fonts are from google or have file paths
typography:
  fonts:
    - family: "Inter"
      source: google  # Will load from Google Fonts
```

### Bootstrap Variables Not Applying

```r
# Ensure you're using bslib functions
page_sidebar(theme = cpal_dashboard_theme(), ...)  # Correct
fluidPage(...)  # Won't apply Bootstrap customizations
```

---

## Asset Directory Structure

```
inst/
├── brand/
│   └── _brand.yml
├── assets/
│   ├── logos/
│   │   ├── CPAL_Logo_Teal.png
│   │   ├── CPAL_Logo_White.png
│   │   └── cpal-logo-wide.png
│   ├── icons/
│   │   ├── CPAL_Icon_Teal.png
│   │   ├── CPAL_Icon_White.png
│   │   └── CPAL_Skyline_*.png
│   └── favicons/
│       ├── CPAL_favicon.ico
│       └── cpal-favicon.ico
└── scss/
    └── cpal_enhanced.scss
```

---

## Next Steps

- [Shiny Dashboards](shiny-dashboards.qmd) - Using brand in dashboards
- [Colors & Palettes](colors-palettes.qmd) - Color system details
- [Project Setup](project-setup.qmd) - Creating branded projects
